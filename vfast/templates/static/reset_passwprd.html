<!DOCTYPE html>
<html lang="en">
<head>
    <script src="/static/js/getVerifyCode.js"></script>
    <meta charset="UTF-8">
    <title>忘记密码</title>
    {% include "head.html" %}
    <style>
        .zhangtai_1{
            margin: 0 auto;
           width: 300px;
           height:270px;
           background-color: #fff;
        }
        .zhangtai_1>div{
            margin-left: 15px;
        }
        .zhangtai_1>div>input{
            margin-top: 10px;
            width: 200px;
            height: 25px;
        }
        .zhangtai_1>div>p{
            margin: 0 !important;
        }
        .getverify-code-btn{
            margin-top: 10px;
			display: inline-block;
			text-align: center;
			vertical-align: middle;
			cursor: pointer;
            width: 268px;
            height: 30px;
            background-color: #5ACD91;
            border-radius: 3px;
            border-width: 0px ;
		}
		.unlabed{
			background-color: lightblue;
			color: #eee;
		}
        .span_v{
            height: 30px;
            line-height: 30px;
        }
    </style>
</head>
<body>
      <main class="main-wrap">
    <header id="navbar1" class="navbar1">{% include "navbar.html" %}</header>
    <!-- 忘记密码-->
              <div class="zhangtai_1">
                 <div>
                  <h3>短信验证码</h3>
                  <p>短信验证码以发送至<span style="color:green;">{{ request.session.phone }}</span></p>
                  <input type="text"   name="phone" id="j_phone" value=""><button id="j_getVerifyCode" style="width: 67px;height: 25px">59s</button>
                 </div>
                  <div>
                      <input type="text" style="width: 267px" id="passwd" value="" placeholder="请输入新密码"/>
                      <button id="commit"  class="getverify-code-btn", onclick="commit()">确认提交</button>
                  </div>
              </div>
          <div class="slideDIV" style="height:150px;"></div>
          <footer class="footer_curr" id="footer_curr">{% include "footer.html" %}</footer></div>
</main>
      <script>
          $(function () {
               //获取手机验证码
               $("#j_phone").on("click", getVerifyCode({
                   callBack: function () {//按钮点击后的回调函数，-----必须-----
                       //在这里你还是可以对你的按钮进行操作;
                       var sde = $("#j_phone").val();
                         console.log(sde);
                       var  phone = true;
                       console.log(phone)
                      //console.log(this);
                       },
                  time: 60,//定时时间，以秒为单位，默认60秒
                  getCurrentTime: function (time) {//获取倒计时当前时间
                      //console.log(time);
                       //console.log(this);//这里的这个this执行按钮
                       //console.log("=================================");
                   },
                   isPhone: true,//是否为发送手机验证码，如果是则会验证手机号格式，-----必须-----
                   getPhone: function () {//获取手机号，此处一定要return
                      return $("#j_phone").val();
                   },
                   //phoneReg: /^1[34578]\d{9}$/,//手机号验证正则
                   phoneCallBack: function () {//当手机号有误时的回调，默认会中止操作
                      $("#phone_info").html("你的输入有误");
                   },
                  timeIsUpText: "重新发送",//倒计时时间到了后按钮所显示文字
                   timeRunnigText: "s后重新发送",//倒计时时间正在走的时候按钮所显示文字。默认为"xxs后重新获取"
                  unabledClass: "unlabed"//按钮不能用的样式，即点击按钮后的样式
               }));
           });
          function commit() {
              var code = document.getElementById('j_phone').value
              var passwd = document.getElementById('passwd').value

             $.post('/u/newpasswd', {'code':code, 'password':passwd}, function (data) {
                 data = JSON.parse(data)
                 console.log(data)
                 if (data.code == 0){
                     location.href = data.url
                 }
                 else{
                     alert(data.msg)
                 }
             })
          }
      </script>
<form id="fileForm"></form>
{% include "search_div.html" %}
{% include "feedback.html" %}
</body>
{% include "commonJS.html" %}
</html>